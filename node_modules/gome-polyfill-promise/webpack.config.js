const webpack = require('webpack')

function build (type) {
	if(type == 'dist'){
		return {
			entry: './index.js',
			output: {
				path: __dirname + '/dist',
				filename: 'promise.js',
				library: 'Promise',
				libraryTarget: 'umd'
			},
			module: {
				rules: [
					{
						test: /\.js$/,
						use: {
							loader: 'babel-loader'
						}
					}
				]
			},
			plugins: [
				new webpack.optimize.UglifyJsPlugin({
					compress: {
						warnings: false
					}
				})
			]
		}
	}else{
		return {
			entry: './test/index.js',
			output: {
				path: __dirname + '/test',
				filename: 'test.js',
				library: 'testPromise',
				libraryTarget: 'umd'
			},
			module: {
				rules: [
					{
						test: /\.js$/,
						use: {
							loader: 'babel-loader'
						}
					}
				]
			}
		}
	}
	
}

module.exports = [build('dist'), build('test')]