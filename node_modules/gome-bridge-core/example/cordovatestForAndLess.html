<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .block{
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="userInfo">
        <a href="javascript:;">当前登陆的用户名为：<span class="red"  id="username"></span></a>
    </div>
    <div class="block">
        <button class="btn" onClick="setHeadBar()">设置标题</button>
        <div class="showCon"></div>
    </div>
    <div class="block">
        <button class="btn" onClick="setHeadBar2()">设置headbar关闭和分享按钮</button>
        <div class="showCon"></div>
    </div>
     <div class="block">
        <button class="btn" onClick="setHeadBar3()">设置headbar更多按钮</button>
        <div class="showCon"></div>
    </div>
    <div class="block">
        <button class="btn" onClick="callShareComp()">调起分享按钮（默认）</button>
        <div class="showCon"></div>
    </div>
    <div class="block">
        <button class="btn" onClick="callShareComp2()">调起分享按钮（设置只分享到QQ，微博，QZone）</button>
        <div class="showCon"></div>
    </div>
    <div class="block">
        <button class="btn" onClick="toast()">toast</button>
    </div>
    <div class="block" id="getLocation">
        <button class="btn" onClick="getLocation()">获取当前定位（四级地址）</button>
        <div class="showCon"></div>
    </div>
    <div class="block" id="getDeviceId">
        <button class="btn" onClick="getDeviceId()">获取设备ID</button>
        <div class="showCon"></div>
    </div>
    <div class="block" id="">
        <button class="btn" onClick="showLoadingComp()">显示loading ，五秒后消失</button>
        <div class="showCon"></div>
    </div>
    <div class="block" id="">
        <button class="btn" onClick="showErrorComp()">显示错误界面 ，五秒后消失</button>
        <div class="showCon"></div>
    </div>
    <div class="block" id="fetchEle">
        <button class="btn" onClick="fetch()">发送请求</button>
        <div class="showCon"></div>
    </div>
    <div class="block">
        <button class="btn" onClick="pushWindow()">打开国美手机端</button>
        <div class="showCon"></div>
    </div>
    <div class="block">
        <button class="btn" onClick="popWindow()">关闭页面</button>
        <div class="showCon"></div>
    </div>
    <script src="http://10.69.59.49:9090/dist/GomeJSBridge.min.js"></script>
    <script>
        // var GomeJSBridge = require('gome-bridge-core/dist/GomeJSBridge.min.js');

        // console.log('2222',GomeJSBridge)

        document.addEventListener('deviceready',function(){
            console.log('deviceready')
            
        },false)
        // window.login = function (){
        //     GomeJSBridge.login(function(data){
        //         data = typeof data == "string" ? JSON.parse(data) : data
        //         alert('当前的登录状态为:',data.isLogin)
        //     },function(err){
        //         alert(err)
        //     })
        // }

        GomeJSBridge.isLogin(function(data){
            if(data.isLogined && data.isLogined == 'N'){
                GomeJSBridge.login();
            }else{
                GomeJSBridge.getUserInfo(function(data){
                    if(data && data.nickName){
                        document.getElementById('username').innerHTML = data.nickName
                    }
                },function(err){
                    console.log(err)
                })
            }
        },null)
        window.getUserInfo = function(){
            GomeJSBridge.getUserInfo(function(data){
                data = typeof data == 'string' ? JSON.parse(data) : data
                // alert('当前登录的用户名：',data.nickName,'手机号为:' + data.mobile)
            },function(err){
                alert(err)
            })
        }

        window.toast = function(){
            GomeJSBridge.toast(function(data){
                console.log(data)
            },null,'我是toast，大概在两三秒之后我就被干掉了')
        }
        //默认的分享
        window.callShareComp = function(){
            var param = {
                                title:'李易峰李易峰',
                                shareDesc:'好帅好帅好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦',
                                shareImageUrl:'http://gfs5.gomein.net.cn/T140xvB5L_1RCvBVdK.jpg',
                                shareUrl:'http://m.gome.com.cn',
                                channel :'link'
                            }
            GomeJSBridge.callShareComp(function(data){
                console.log(data)
                // alert()
            },function(err){
                console.log(err)
            },param)
        }

        //设置了platform的分享，分享平台为WeiBo','Wechat','GomeMyCircle','QQ','QZone','CopyLink','GomeMoments'
        window.callShareComp2 = function(){
            var param = {
                                title:'李易峰李易峰',
                                shareDesc:'好帅好帅好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦好帅哦',
                                shareImageUrl:'http://gfs5.gomein.net.cn/T140xvB5L_1RCvBVdK.jpg',
                                shareUrl:'http://m.gome.com.cn',
                                channel :'link',
                                platform: ['WeiBo','Wechat','GomeMyCircle','QQ','QZone','CopyLink','GomeMoments']
                            }
            GomeJSBridge.callShareComp(function(data){
                console.log('分享到：', data)
                GomeJSBridge.toast(null,null,'分享到：'+ data.platform ? data.platform : '什么鬼')
                // alert()
            },function(err){
                console.log(err)
            },param)
        }

        window.pushWindow = function(){
            var url = 'http://m.gomeplus.com'
            GomeJSBridge.pushWindow(function(data){
                console.log(data)
            },function(err){
                console.log(err)
            }, url)
        }
        // 关闭当前页面。最后调用
        window.popWindow = function(){
            GomeJSBridge.popWindow()
        }
        //设置
        //设置标题
        window.setHeadBar = function(){
            var param = {
                title :'这是黑化后的标题',
                titleColor :'ff5c5c',
                bgColor :'000000',
                menus:{

                }
            } 
            GomeJSBridge.setHeadBar(function(data){
                console.log(data)
            },function(err){
                console.log(err)
            },param)
        }
        //设置关闭按钮 和分享按钮
        window.setHeadBar2 = function(){
            var param = {
                title :'这是黑化后的标题',
                titleColor :'ff5c5c',
                bgColor :'000000',
                menus : {
                    isShowCloseMenu:'Y',
                    isShowShareMenu:'Y',
                    shareMenu:{
                        title:'分享标题 陈伟霆',
                        shareDesc:'帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅',
                        shareUrl:'http://hd.m.gomeplus.com/hybrid-meidian-index.html?keyProms=sale8QrcVlMxlpD&intcmp=sy-4089055-1',
                        shareImageUrl:'http://gfs17.gomein.net.cn/T1MJJTBb_T1RCvBVdK_160.jpg'
                    },
                }
            } 
            GomeJSBridge.setHeadBar(function(data){
                console.log(data)
            },function(err){
                console.log(err)
            },param)
        }
        //设置右侧按钮
        window.setHeadBar3 = function(){
            var param = {
                title :'保护我方诸葛亮',
                titleColor :'ff5c5c',
                bgColor :'000000',
                menus : {
                    isShowCloseMenu:'Y',
                    isShowShareMenu:'Y',
                    shareMenu:{
                        title:'分享标题 鹿晗鹿晗',
                        shareDesc:'帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅帅',
                        shareUrl:'http://hd.m.gomeplus.com/hybrid-meidian-index.html?keyProms=sale8QrcVlMxlpD&intcmp=sy-4089055-1',
                        shareImageUrl:'http://gfs17.gomein.net.cn/T1MJJTBb_T1RCvBVdK_160.jpg'
                    },
                    otherMenus:[
                            {
                                type:'scheme',
                                title:'我的评价',
                                // icon:'https://i-pre.meixincdn.com/v1/img/T1PRYTBsYT1RXrhCrK.jpg',
                                icon:'',
                                action:'http://u.m.atguat.com.cn/my_evaluate-0.html'
                            },
                            {
                                type:'scheme',
                                title:'我的评价',
                                icon:'https://i-pre.meixincdn.com/v1/img/T1PRYTBsYT1RXrhCrK.jpg',
                                action:'http://u.m.atguat.com.cn/my_evaluate-0.html'
                            }
                        ]
                }
            } 
            GomeJSBridge.setHeadBar(function(data){
                console.log(data)
            },function(err){
                console.log(err)
            },param)
        }
        //发动请求
        window.fetch = function(){
            var param = {
                            param:{
                                extendParams :{
                                                    clientReferer : "m.gome.com.cn",
                                                },
                                cityId : "11010000",
                                provinceId :"11000000",
                                keyProms : "saleq4DxzajGg5a",
                            },
                            isNeedLoading:"Y",
                            url:"http://prom.mobile.atguat.com.cn/mobile/promotion/promscms/promscms.jsp",
                            method:"POST",
                            isPostBody:"N"
                            };
            GomeJSBridge.fetch(function(data){
                data = typeof data == "string" ? data : JSON.stringify(data)
                document.getElementById('fetchEle').getElementsByClassName('showCon')[0].innerHTML = '请求回来的数据为：' + data
            },function(err){
                console.log(err)
                document.getElementById('fetchEle').getElementsByClassName('showCon')[0].innerHTML = JSON.stringify(err)
            },param)
        }

        window.getLocation = function(){
            // 当前的定位
            // document.getElementById('getLocation').getElementsByClassName('showCon')[0].innerHTML = 'dddddddd'
            GomeJSBridge.getLocation(function(data){
                // 当前的位置为
                console.log(data)
                document.getElementById('getLocation').getElementsByClassName('showCon')[0].innerHTML = data.province.name + data.city.name + data.district.name + data.town.name
                // alert('当前的位置为：',data.province.name + data.city.name + data.district.name + data.town.name)
            },function(err){
                console.log(err)
            })
        }

        window.getDeviceId = function(){
            // 当前的定位
            GomeJSBridge.getDeviceId(function(data){
                // 当前的位置为
                console.log(data)
                document.getElementById('getDeviceId').getElementsByClassName('showCon')[0].innerHTML = data.manufacturer + '   /   ' + data.model + '   /   ' + data.platform + '  /  ' + data.version
                // alert('手机为：',data.manufacturer + '   /   ' + data.model + '   /   ' + data.platform + '  /  ' + data.version)
            },function(err){
                console.log(err)
            })
        }

        // /显示loading，五秒后隐藏
        window.showLoadingComp = function(){
            GomeJSBridge.showLoadingComp(function(data){
                console.log(data)
            },function(err){
                console.log(err)
            })
            setTimeout(function(){
                GomeJSBridge.hideLoadingComp(function(data){
                    console.log(data)
                },function(err){
                    console.log(err)
                })
            },5000)
        }

        // /显示错误组件，五秒后隐藏
        window.showErrorComp = function(){
            GomeJSBridge.showErrorComp(function(data){
                console.log(data)
            },function(err){
                console.log(err)
            })
            setTimeout(function(){
                GomeJSBridge.hideErrorComp(function(data){
                    console.log(data)
                },function(err){
                    console.log(err)
                })
            },5000)
        }
    </script>
</body>
</html>