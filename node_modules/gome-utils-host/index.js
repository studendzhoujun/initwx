/*
 * @Author: zhaoye 
 * @Date: 2017-01-03 17:54:33 
 * @Last Modified by: liuxiaocong
 * @Last Modified time: 2018-05-18 14:00:09
 */

//站点域名
import {location} from 'gome-utils-bom'
import {env, system} from 'gome-utils-env'
import version from 'gome-utils-app-version'
let host = {}
Object.defineProperty(host, '__root', {
    get: () =>{
        let _host = ''
        if(env.hybrid){
            //混合app
            //国美在线
            if(env.gome){
                if(env.live)
                    _host = 'gome.com.cn'
                else if(env.uat)
                    _host = 'atguat.com.cn'
                else if(env.tslive)
                    _host = 'tslive.com.cn'
                else
                    _host = 'gome.com.cn'
            }else{
                //默认国美
                if(env.live)
                    _host = 'gomeplus.com'
                else if(env.uat)
                    _host = 'uatplus.com'
                else if(env.tslive)
                //瞎写的
                    _host = 'tsliveplus.com'
                else
                    _host = 'gome.com.cn'
            }
        }else{
            if(location.getHref().match(/gome\.com\.cn|atguat|uat\b|tslive\./)){
                if(env.live)
                    _host = 'gome.com.cn'
                else if(env.uat){
                    if (location.getHref().match(/\.uat/)) {
                        _host = 'uat.com.cn'
                    } else {
                        _host = 'atguat.com.cn'
                    }
                }
                else if(env.tslive)
                    _host = 'tslive.com.cn'
                else
                    _host = 'gome.com.cn'
            }else{
                // @Deprecated
                //默认国美
                if(env.live)
                    _host = 'gomeplus.com'
                else if(env.uat)
                    _host = 'uatplus.com'
                else if(env.tslive)
                    _host = 'tsliveplus.com'
                else
                    _host = 'gome.com.cn'
            }
        }
        return _host
        // return 'm.' + host.__root;
    }
})
Object.defineProperty(host, '_mRoot', {
    get: () =>{
        return 'm.' + host.__root
    }
})
//协议头
let protocal = ''

if(env.hybrid){
    if(env.gome && system.ios && version >= 75){
        protocal = 'https:'
    }else if(env.gomeplus && system.ios){
        protocal = 'https:'
    }else{
        protocal = 'http:'
    }
}

host.m     = protocal + '//'       + host._mRoot
host.prom  = protocal + '//prom.'  + host._mRoot
host.jr    = protocal + '//jr.'    + host._mRoot
host.hd    = protocal + '//hd.'    + host._mRoot
host.v     = protocal + '//v.'     + host._mRoot
host.tuan  = protocal + '//tuan.'  + host._mRoot
host.u     = protocal + '//u.'     + host._mRoot
host.item  = protocal + '//item.'  + host._mRoot
host.q     = protocal + '//q.'     + host._mRoot
host.cart  = protocal + '//cart.'  + host._mRoot
host.pt    = protocal + '//pt.'    + host._mRoot
host.club  = protocal + '//club.'  + host._mRoot
host.login  = protocal + '//login.'  + host._mRoot
host.protocal = protocal

host.get = (domain) => {
    return `${protocal}//${domain}.${host.__root}`
}

host.service = {}
Object.defineProperty(host.service, '__root', {
    get: () =>{
        let _host = ''
        if(env.hybrid){
            //混合app
            //国美在线
            if(!env.gome){
                //默认美信
                if(env.live)
                    _host = 'mobile.gomeplus.com'
                else if(env.uat)
                    _host = 'mobile.uatplus.com'
                else if(env.tslive)
                //瞎写的
                    _host = 'mobile.tsliveplus.com'
                else
                    _host = 'mobile.gomeplus.com'
                
            }else{
                if(env.live)
                    _host = 'mobile.gome.com.cn'
                else if(env.uat)
                    _host = 'mobile.atguat.com.cn'
                else if(env.tslive)
                    _host = 'mobile.tslive.com.cn'
                else
                    _host = 'mobile.gome.com.cn'
            }
        }else{
            //混合app
            //国美在线
            if(location.getHref().match(/gome\.com\.cn|atguat|uat\b/)){
                if(env.live)
                    _host = 'mobile.gome.com.cn'
                else if(env.uat) {
                    if(location.getHref().match(/\.uat/))
                        _host = 'mobile.uat.com.cn'
                    else
                        _host = 'mobile.atguat.com.cn'
                }
                else if(env.tslive)
                    _host = 'mobile.tslive.com.cn'
                else
                    _host = 'mobile.gome.com.cn'
            }else{
                //默认美信
                if(env.live)
                    _host = 'mobile.gomeplus.com'
                else if(env.uat)
                    _host = 'mobile.uatplus.com'
                else if(env.tslive)
                //瞎写的
                    _host = 'mobile.tsliveplus.com'
                else
                    _host = 'mobile.gomeplus.com'
            }
        }
        return _host
    }
})

host.service.get = (domain) => {
    if (domain.trim() == 'cms') {
        return host.service.cms
    } else if (domain.trim() == 'gomeplus') {
        return host.gomeplus
    }
}

host.service.cms = (function(){
    let pre
    if(!env.hybrid && !env.gome){
        pre = 'https://prom-'
        if(!env.live){
            pre = 'http://prom.'
        }
    }else{
        pre = protocal + '//prom-'
        if(!env.live){
            pre = 'http://prom.'
        }
    }
    if (env.uat) {
        return `http://prom.mobile.uatplus.com`
    } else {
        return pre + host.service.__root
    }
})();

function gomeplusRoot(){
    if(env.uat){
        return 'pre.gomeplus.com'
    }else if(env.tslive){
        return 'pre.gomeplus.com'
    }else{
        return 'pro.gomeplus.com'
    }
}

host.service.gomeplus = (function () {
    if(env.uat){
        return 'https://api-bs-pre.gomeplus.com'
    }else if(env.tslive){
        return 'https://api-bs-pre.gomeplus.com'
    }else{
        return 'https://api-bs.gomeplus.com'
    }
})()

export {host}
export default host